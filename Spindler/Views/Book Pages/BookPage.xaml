<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Spindler.ViewModels"
             xmlns:models="clr-namespace:Spindler.Models"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:DataType="viewmodels:BookViewModel"
             x:Class="Spindler.BookPage">



    <Shell.TitleView>
        <Grid ColumnDefinitions="*, auto">

            <Label Text="{Binding Title}" Grid.Column="0" FontSize="Large" VerticalOptions="Center" HorizontalOptions="FillAndExpand" TextColor="{StaticResource Primary}"/>
            <StackLayout Grid.Column="1" HorizontalOptions="EndAndExpand" Orientation="Horizontal" VerticalOptions="Center" Margin="0,0,10,0">
                <ImageButton x:Name="AddToolBarItem"
                             HeightRequest="25"
                             WidthRequest="25"
                             Source="plus.svg"
                             Command="{Binding AddToolBarItemCommand}">
                    <ImageButton.Behaviors>
                        <toolkit:IconTintColorBehavior TintColor="{AppThemeBinding Dark={StaticResource White}, Light={StaticResource Black}}"/>
                    </ImageButton.Behaviors>
                </ImageButton>
            </StackLayout>
        </Grid>
    </Shell.TitleView>
    <CollectionView x:Name="BooksList"
                        ItemsSource="{Binding BookList}"
                        SelectedItem="{Binding CurrentSelection}"
                        SelectionChangedCommand="{Binding SelectionCommand}"
                        RemainingItemsThreshold="3"
                        RemainingItemsThresholdReachedCommand="{Binding EndOfListReachedCommand}"
                        SelectionMode="Single"
                        ItemSizingStrategy="MeasureFirstItem"
                        Margin="5">
        <CollectionView.ItemsLayout>
            <LinearItemsLayout ItemSpacing="10" Orientation="Vertical"/>
        </CollectionView.ItemsLayout>
        <CollectionView.ItemTemplate>
            <DataTemplate>
<<<<<<< HEAD
                <Border StrokeShape="RoundRectangle 16,10,16,10" Stroke="{StaticResource LightSpaceCadet}">
                    <Grid x:DataType="models:Book">
=======
                <Border StrokeShape="RoundRectangle 16,10,16,10" Stroke="{AppThemeBinding Dark={StaticResource White}, Light={StaticResource SpaceCadet}}">
                    <Grid Padding="10,0,0,0" x:DataType="models:Book" BackgroundColor="{AppThemeBinding Dark={StaticResource DarkCardBackground}, Light={StaticResource White}}">
>>>>>>> master
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="30"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="50"/>
                            <RowDefinition Height="2"/>
                            <RowDefinition Height="40"/>
                        </Grid.RowDefinitions>
                        <Label VerticalTextAlignment="Center" HorizontalTextAlignment="Center" FontSize="Medium" x:Name="TitleLabel" Text="{Binding Title}" MaxLines="2" Padding="10,0,5,0"/>
                        <Line BackgroundColor="{StaticResource LightSpaceCadet}" HorizontalOptions="Fill" Grid.Row="1"/>
                        <Label x:Name="UrlLabel" Text="{Binding Url}" MaxLines="2" FontSize="Small" Grid.Row="2" VerticalOptions="Fill" Padding="10,5,10,0" />

<<<<<<< HEAD
                        <ContentView Grid.Column="1" Grid.RowSpan="3" BackgroundColor="{StaticResource LightSpaceCadet}">
                            <ImageButton HorizontalOptions="Center" VerticalOptions="Center" Source="kebab.svg"
                                         Aspect="AspectFit" x:Name="ConfigButton" Padding="4"
=======
                        <ImageButton HorizontalOptions="Center" VerticalOptions="Center" Grid.Column="1" Grid.Row="2" Source="kebab.svg"
                                         Margin="0,0,0,5" Aspect="AspectFit" x:Name="ConfigButton" 
>>>>>>> master
                                         Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:BookViewModel}}, Path=ConfigButtonCommand}" CommandParameter="{Binding}">
                                <ImageButton.Behaviors>
                                    <toolkit:IconTintColorBehavior TintColor="{AppThemeBinding Dark={StaticResource White}, Light={StaticResource LightSpaceCadet}}"/>
                                </ImageButton.Behaviors>
                            </ImageButton>
                        </ContentView>
                    </Grid>
                </Border>
            </DataTemplate>
        </CollectionView.ItemTemplate>
        <CollectionView.EmptyView>
            <VerticalStackLayout Padding="10">
                <Label FontSize="50" Text="No Books loaded"/>
                <Label Padding="0,50,0,0" FontSize="20" Text="Please Reload the list or add some items."/>
            </VerticalStackLayout>
        </CollectionView.EmptyView>
        <CollectionView.Footer>
            <ActivityIndicator IsRunning="{Binding IsLoading}" HeightRequest="{Binding LoaderHeightRequest}" Color="{StaticResource Primary}"/>
        </CollectionView.Footer>
    </CollectionView>
</ContentPage>
